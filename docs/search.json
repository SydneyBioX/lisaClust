[{"path":"https://github.com/ellispatrick/lisaClust/articles/lisaClust.html","id":"installation","dir":"Articles","previous_headings":"","what":"Installation","title":"Introduction to Clustering of Local Indicators of Spatial Assocation (LISA) curves","text":"","code":"if (!require(\"BiocManager\"))     install.packages(\"BiocManager\") BiocManager::install(\"lisaClust\") # load required packages library(lisaClust) library(spicyR) library(ggplot2) library(SingleCellExperiment)"},{"path":"https://github.com/ellispatrick/lisaClust/articles/lisaClust.html","id":"overview","dir":"Articles","previous_headings":"","what":"Overview","title":"Introduction to Clustering of Local Indicators of Spatial Assocation (LISA) curves","text":"Clustering local indicators spatial association (LISA) functions methodology identifying consistent spatial organisation multiple cell-types unsupervised way. can used enable characterization interactions multiple cell-types simultaneously can complement traditional pairwise analysis. implementation LISA curves localised summary L-function Poisson point process model. framework lisaClust can used provide high-level summary cell-type colocalization high-parameter spatial cytometry data, facilitating identification distinct tissue compartments identification complex cellular microenvironments.","code":""},{"path":[]},{"path":"https://github.com/ellispatrick/lisaClust/articles/lisaClust.html","id":"generate-toy-data","dir":"Articles","previous_headings":"Quick start","what":"Generate toy data","title":"Introduction to Clustering of Local Indicators of Spatial Assocation (LISA) curves","text":"illustrate lisaClust framework, consider simple toy example two cell-types completely separated spatially. simulate data two different images.","code":"set.seed(51773) x <- round(c(runif(200),runif(200)+1,runif(200)+2,runif(200)+3,            runif(200)+3,runif(200)+2,runif(200)+1,runif(200)),4)*100 y <- round(c(runif(200),runif(200)+1,runif(200)+2,runif(200)+3,              runif(200),runif(200)+1,runif(200)+2,runif(200)+3),4)*100 cellType <- factor(paste('c',rep(rep(c(1:2),rep(200,2)),4),sep = '')) imageID <- rep(c('s1', 's2'),c(800,800))  cells <- data.frame(x, y, cellType, imageID)  ggplot(cells, aes(x,y, colour = cellType)) + geom_point() + facet_wrap(~imageID)"},{"path":"https://github.com/ellispatrick/lisaClust/articles/lisaClust.html","id":"create-segmentedcellexperiment-object","dir":"Articles","previous_headings":"Quick start","what":"Create SegmentedCellExperiment object","title":"Introduction to Clustering of Local Indicators of Spatial Assocation (LISA) curves","text":"First store data SegmentedCells object.","code":"cellExp <- SegmentedCells(cells, cellTypeString = 'cellType')"},{"path":"https://github.com/ellispatrick/lisaClust/articles/lisaClust.html","id":"running-lisaclust","dir":"Articles","previous_headings":"Quick start","what":"Running lisaCLust","title":"Introduction to Clustering of Local Indicators of Spatial Assocation (LISA) curves","text":"can use convience function lisaClust simultaneously calculate local indicators spatial association (LISA) functions using lisa function perform k-means clustering.","code":"cellExp <- lisaClust(cellExp, k = 2)"},{"path":"https://github.com/ellispatrick/lisaClust/articles/lisaClust.html","id":"plot-identified-regions","dir":"Articles","previous_headings":"Quick start","what":"Plot identified regions","title":"Introduction to Clustering of Local Indicators of Spatial Assocation (LISA) curves","text":"hatchingPlot function can used construct ggplot object regions marked different hatching patterns. allows us plot regions cell-types visualization.","code":"hatchingPlot(cellExp, useImages = c('s1','s2'))"},{"path":"https://github.com/ellispatrick/lisaClust/articles/lisaClust.html","id":"using-other-clustering-methods-","dir":"Articles","previous_headings":"Quick start","what":"Using other clustering methods.","title":"Introduction to Clustering of Local Indicators of Spatial Assocation (LISA) curves","text":"lisaClust function convenient, implemented exhaustive suite clustering methods easy . just two simple steps.","code":""},{"path":"https://github.com/ellispatrick/lisaClust/articles/lisaClust.html","id":"generate-lisa-curves","dir":"Articles","previous_headings":"Quick start > Using other clustering methods.","what":"Generate LISA curves","title":"Introduction to Clustering of Local Indicators of Spatial Assocation (LISA) curves","text":"can calculate local indicators spatial association (LISA) functions using lisa function. LISA curves localised summary L-function Poisson point process model. radii calculated can set Rs.","code":"lisaCurves <- lisa(cellExp, Rs = c(20, 50, 100))"},{"path":"https://github.com/ellispatrick/lisaClust/articles/lisaClust.html","id":"perform-some-clustering","dir":"Articles","previous_headings":"Quick start > Using other clustering methods.","what":"Perform some clustering","title":"Introduction to Clustering of Local Indicators of Spatial Assocation (LISA) curves","text":"LISA curves can used cluster cells. use k-means clustering, clustering methods like SOM used. can store cell clusters cell “regions” SegmentedCells object using cellAnnotation() <- function.","code":"kM <- kmeans(lisaCurves,2) cellAnnotation(cellExp, \"region\") <- paste('region',kM$cluster,sep = '_')"},{"path":"https://github.com/ellispatrick/lisaClust/articles/lisaClust.html","id":"alternative-hatching-plot","dir":"Articles","previous_headings":"Quick start","what":"Alternative hatching plot","title":"Introduction to Clustering of Local Indicators of Spatial Assocation (LISA) curves","text":"also create plot using geom_hatching scale_region_manual. ## Faster ploting hatchingPlot can quite slow large images high nbp linewidth. often useful simply plot regions without cell type information.","code":"df <- as.data.frame(cellSummary(cellExp))  p <- ggplot(df,aes(x = x,y = y, colour = cellType, region = region)) +    geom_point() +    facet_wrap(~imageID) +   geom_hatching(window = \"concave\",                  line.spacing = 11,                  nbp = 50,                  line.width = 2,                  hatching.colour = \"gray20\",                 window.length = NULL) +   theme_minimal() +    scale_region_manual(values = 6:7, labels = c('ab','cd'))  p df <- as.data.frame(cellSummary(cellExp)) df <- df[df$imageID == \"s1\", ]  p <- ggplot(df,aes(x = x,y = y, colour  = region)) +    geom_point() +   theme_classic() p"},{"path":"https://github.com/ellispatrick/lisaClust/articles/lisaClust.html","id":"using-a-singlecellexperiment","dir":"Articles","previous_headings":"","what":"Using a SingleCellExperiment","title":"Introduction to Clustering of Local Indicators of Spatial Assocation (LISA) curves","text":"lisaClust function also works SingleCellExperiment. First lets create SingleCellExperiment object. lisaClust just needs columns colData corresponding x y coordinates cells, column annotating cell types cells column indicating image cell came . can plot regions using following.","code":"sce <- SingleCellExperiment(colData = cellSummary(cellExp)) sce <- lisaClust(sce,                   k = 2,                   spatialCoords = c(\"x\", \"y\"),                   cellType = \"cellType\",                  imageID = \"imageID\") hatchingPlot(sce)"},{"path":"https://github.com/ellispatrick/lisaClust/articles/lisaClust.html","id":"damond-et-al--islet-data-","dir":"Articles","previous_headings":"","what":"Damond et al. islet data.","title":"Introduction to Clustering of Local Indicators of Spatial Assocation (LISA) curves","text":"apply lisaClust framework three images pancreatic islets Map Human Type 1 Diabetes Progression Imaging Mass Cytometry Damond et al. (2019).","code":""},{"path":"https://github.com/ellispatrick/lisaClust/articles/lisaClust.html","id":"read-in-data","dir":"Articles","previous_headings":"Damond et al. islet data.","what":"Read in data","title":"Introduction to Clustering of Local Indicators of Spatial Assocation (LISA) curves","text":"start reading data storing SegmentedCells object. data format consistent outputted CellProfiler.","code":"isletFile <- system.file(\"extdata\",\"isletCells.txt.gz\", package = \"spicyR\") cells <- read.table(isletFile, header = TRUE) cellExp <- SegmentedCells(cells, cellProfiler = TRUE)"},{"path":"https://github.com/ellispatrick/lisaClust/articles/lisaClust.html","id":"cluster-cell-types","dir":"Articles","previous_headings":"Damond et al. islet data.","what":"Cluster cell-types","title":"Introduction to Clustering of Local Indicators of Spatial Assocation (LISA) curves","text":"data include annotation cell-types cell. extract marker intensities SegmentedCells object using cellMarks. perform k-means clustering eight clusters store cell-type clusters SegmentedCells object using cellType() <-.","code":"markers <- cellMarks(cellExp) kM <- kmeans(markers,10) cellType(cellExp) <- paste('cluster', kM$cluster, sep = '')"},{"path":"https://github.com/ellispatrick/lisaClust/articles/lisaClust.html","id":"generate-lisa-curves-1","dir":"Articles","previous_headings":"Damond et al. islet data.","what":"Generate LISA curves","title":"Introduction to Clustering of Local Indicators of Spatial Assocation (LISA) curves","text":", can calculate perform k-means clustering local indicators spatial association (LISA) functions using lisaClust function. regions stored cellExp can extracted.","code":"cellExp <- lisaClust(cellExp, k = 2, Rs = c(10,20,50)) cellAnnotation(cellExp, \"region\") |>   head() ## [1] \"region_1\" \"region_1\" \"region_1\" \"region_1\" \"region_1\" \"region_1\""},{"path":"https://github.com/ellispatrick/lisaClust/articles/lisaClust.html","id":"examine-cell-type-enrichment","dir":"Articles","previous_headings":"Damond et al. islet data.","what":"Examine cell type enrichment","title":"Introduction to Clustering of Local Indicators of Spatial Assocation (LISA) curves","text":"check see cell types appear frequently region expected chance.","code":"regionMap(cellExp, type = \"bubble\")"},{"path":"https://github.com/ellispatrick/lisaClust/articles/lisaClust.html","id":"plot-identified-regions-1","dir":"Articles","previous_headings":"Damond et al. islet data.","what":"Plot identified regions","title":"Introduction to Clustering of Local Indicators of Spatial Assocation (LISA) curves","text":"Finally, can use hatchingPlot construct ggplot object regions marked different hatching patterns. allows us visualize two regions ten cell-types simultaneously.","code":"hatchingPlot(cellExp)"},{"path":"https://github.com/ellispatrick/lisaClust/articles/lisaClust.html","id":"sessioninfo","dir":"Articles","previous_headings":"","what":"sessionInfo()","title":"Introduction to Clustering of Local Indicators of Spatial Assocation (LISA) curves","text":"","code":"sessionInfo() ## R version 4.3.1 (2023-06-16) ## Platform: x86_64-pc-linux-gnu (64-bit) ## Running under: Debian GNU/Linux 12 (bookworm) ##  ## Matrix products: default ## BLAS:   /usr/lib/x86_64-linux-gnu/openblas-pthread/libblas.so.3  ## LAPACK: /usr/lib/x86_64-linux-gnu/openblas-pthread/libopenblasp-r0.3.21.so;  LAPACK version 3.11.0 ##  ## locale: ##  [1] LC_CTYPE=C.UTF-8       LC_NUMERIC=C           LC_TIME=C.UTF-8        ##  [4] LC_COLLATE=C.UTF-8     LC_MONETARY=C.UTF-8    LC_MESSAGES=C.UTF-8    ##  [7] LC_PAPER=C.UTF-8       LC_NAME=C              LC_ADDRESS=C           ## [10] LC_TELEPHONE=C         LC_MEASUREMENT=C.UTF-8 LC_IDENTIFICATION=C    ##  ## time zone: Australia/Sydney ## tzcode source: system (glibc) ##  ## attached base packages: ## [1] stats4    stats     graphics  grDevices utils     datasets  methods   ## [8] base      ##  ## other attached packages: ##  [1] SingleCellExperiment_1.23.0 SummarizedExperiment_1.31.1 ##  [3] Biobase_2.61.0              GenomicRanges_1.53.1        ##  [5] GenomeInfoDb_1.37.2         IRanges_2.35.2              ##  [7] S4Vectors_0.39.1            BiocGenerics_0.47.0         ##  [9] MatrixGenerics_1.13.1       matrixStats_1.0.0           ## [11] ggplot2_3.4.2               spicyR_1.13.1               ## [13] lisaClust_1.7.3             BiocStyle_2.29.1            ##  ## loaded via a namespace (and not attached): ##   [1] RColorBrewer_1.1-3        jsonlite_1.8.7            ##   [3] magrittr_2.0.3            spatstat.utils_3.0-3      ##   [5] magick_2.7.4              farver_2.1.1              ##   [7] nloptr_2.0.3              rmarkdown_2.23            ##   [9] fs_1.6.3                  zlibbioc_1.47.0           ##  [11] ragg_1.2.5                vctrs_0.6.3               ##  [13] memoise_2.0.1             minqa_1.2.5               ##  [15] spatstat.explore_3.2-1    DelayedMatrixStats_1.23.0 ##  [17] RCurl_1.98-1.12           htmltools_0.5.5           ##  [19] S4Arrays_1.1.5            curl_5.0.1                ##  [21] Rhdf5lib_1.23.0           SparseArray_1.1.11        ##  [23] rhdf5_2.45.1              sass_0.4.7                ##  [25] bslib_0.5.0               desc_1.4.2                ##  [27] cachem_1.0.8              lifecycle_1.0.3           ##  [29] pkgconfig_2.0.3           Matrix_1.5-3              ##  [31] R6_2.5.1                  fastmap_1.1.1             ##  [33] GenomeInfoDbData_1.2.10   digest_0.6.33             ##  [35] numDeriv_2016.8-1.1       colorspace_2.1-0          ##  [37] rprojroot_2.0.3           tensor_1.5                ##  [39] dqrng_0.3.0               textshaping_0.3.6         ##  [41] beachmat_2.17.14          labeling_0.4.2            ##  [43] fansi_1.0.4               spatstat.sparse_3.0-2     ##  [45] polyclip_1.10-4           abind_1.4-5               ##  [47] mgcv_1.9-0                compiler_4.3.1            ##  [49] withr_2.5.0               BiocParallel_1.35.3       ##  [51] highr_0.10                HDF5Array_1.29.3          ##  [53] ggforce_0.4.1             R.utils_2.12.2            ##  [55] MASS_7.3-60               concaveman_1.1.0          ##  [57] DelayedArray_0.27.10      rjson_0.2.21              ##  [59] tools_4.3.1               goftest_1.2-3             ##  [61] R.oo_1.25.0               glue_1.6.2                ##  [63] nlme_3.1-162              rhdf5filters_1.13.5       ##  [65] grid_4.3.1                generics_0.1.3            ##  [67] gtable_0.3.3              spatstat.data_3.0-1       ##  [69] R.methodsS3_1.8.2         class_7.3-22              ##  [71] tidyr_1.3.0               data.table_1.14.8         ##  [73] utf8_1.2.3                XVector_0.41.1            ##  [75] spatstat.geom_3.2-4       pillar_1.9.0              ##  [77] stringr_1.5.0             limma_3.57.7              ##  [79] splines_4.3.1             dplyr_1.1.2               ##  [81] tweenr_2.0.2              lattice_0.21-8            ##  [83] deldir_1.0-9              tidyselect_1.2.0          ##  [85] locfit_1.5-9.8            scuttle_1.11.2            ##  [87] knitr_1.43                V8_4.3.3                  ##  [89] bookdown_0.34             edgeR_3.43.8              ##  [91] xfun_0.39                 statmod_1.5.0             ##  [93] DropletUtils_1.21.0       pheatmap_1.0.12           ##  [95] fftwtools_0.9-11          scam_1.2-14               ##  [97] stringi_1.7.12            yaml_2.3.7                ##  [99] boot_1.3-28.1             evaluate_0.21             ## [101] codetools_0.2-19          tibble_3.2.1              ## [103] BiocManager_1.30.21.1     cli_3.6.1                 ## [105] systemfonts_1.0.4         munsell_0.5.0             ## [107] jquerylib_0.1.4           Rcpp_1.0.11               ## [109] spatstat.random_3.1-5     parallel_4.3.1            ## [111] pkgdown_2.0.7             sparseMatrixStats_1.13.0  ## [113] bitops_1.0-7              lme4_1.1-34               ## [115] SpatialExperiment_1.11.0  lmerTest_3.1-3            ## [117] scales_1.2.1              purrr_1.0.1               ## [119] crayon_1.5.2              rlang_1.1.1"},{"path":"https://github.com/ellispatrick/lisaClust/authors.html","id":null,"dir":"","previous_headings":"","what":"Authors","title":"Authors and Citation","text":"Ellis Patrick. Author, maintainer. Nicolas Canete. Author.","code":""},{"path":"https://github.com/ellispatrick/lisaClust/authors.html","id":"citation","dir":"","previous_headings":"","what":"Citation","title":"Authors and Citation","text":"Patrick E, Canete N (2023). lisaClust: lisaClust: Clustering Local Indicators Spatial Association. https://ellispatrick.github.io/lisaClust/, https://github.com/ellispatrick/lisaClust.","code":"@Manual{,   title = {lisaClust: lisaClust: Clustering of Local Indicators of Spatial Association},   author = {Ellis Patrick and Nicolas Canete},   year = {2023},   note = {https://ellispatrick.github.io/lisaClust/, https://github.com/ellispatrick/lisaClust}, }"},{"path":"https://github.com/ellispatrick/lisaClust/index.html","id":"lisaclust","dir":"","previous_headings":"","what":"lisaClust: Clustering of Local Indicators of Spatial Association","title":"lisaClust: Clustering of Local Indicators of Spatial Association","text":"Clustering Local Indicators Spatial Association","code":""},{"path":"https://github.com/ellispatrick/lisaClust/index.html","id":"overview","dir":"","previous_headings":"","what":"Overview","title":"lisaClust: Clustering of Local Indicators of Spatial Association","text":"lisaClust provides series functions identify visualise regions tissue spatial associations cell-types similar. package can used provide high-level summary cell-type colocalisation multiplexed imaging data segmented single-cell resolution.","code":""},{"path":"https://github.com/ellispatrick/lisaClust/index.html","id":"installation","dir":"","previous_headings":"","what":"Installation","title":"lisaClust: Clustering of Local Indicators of Spatial Association","text":"Bioconductor release version, run following. like --date features, install recent development version.","code":"if (!require(\"BiocManager\", quietly = TRUE))     install.packages(\"BiocManager\")  BiocManager::install(\"lisaClust\") # Install the development version from Bioconductor: if (!require(\"BiocManager\", quietly = TRUE))     install.packages(\"BiocManager\")  # The following initializes usage of Bioc devel # This will update all your Bioconductor packages to devel version BiocManager::install(version='devel')  BiocManager::install(\"lisaClust\")  # Otherwise install the development version from GitHub: # install.packages(\"devtools\") devtools::install_github(\"ellispatrick/lisaClust\") library(lisaClust)"},{"path":"https://github.com/ellispatrick/lisaClust/index.html","id":"submitting-an-issue-or-feature-request","dir":"","previous_headings":"","what":"Submitting an issue or feature request","title":"lisaClust: Clustering of Local Indicators of Spatial Association","text":"listClust still active development. greatly appreciate feedback related package. R package related issues raised . general questions feedback, please contact us directly via ellis.patrick@sydney.edu.au.","code":""},{"path":"https://github.com/ellispatrick/lisaClust/index.html","id":"authors","dir":"","previous_headings":"","what":"Authors","title":"lisaClust: Clustering of Local Indicators of Spatial Association","text":"Nicolas Canete Ellis Patrick - @TheEllisPatrick","code":""},{"path":"https://github.com/ellispatrick/lisaClust/index.html","id":"citation","dir":"","previous_headings":"","what":"Citation","title":"lisaClust: Clustering of Local Indicators of Spatial Association","text":"Patrick, E, Canete, NP, Iyengar, SS, Harman, , Sutherland, GT, Yang, P. Spatial analysis highly multiplexed imaging data identify tissue microenvironments. Cytometry. 2023. https://doi.org/10.1002/cyto..24729","code":""},{"path":"https://github.com/ellispatrick/lisaClust/reference/hatchingPlot.html","id":null,"dir":"Reference","previous_headings":"","what":"hatchingPlot — hatchingPlot","title":"hatchingPlot — hatchingPlot","text":"hatchingPlot() function used create hatching patterns representating  spatial regions cell-types. hatching geom used create hatching patterns representation spatial regions.","code":""},{"path":"https://github.com/ellispatrick/lisaClust/reference/hatchingPlot.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"hatchingPlot — hatchingPlot","text":"","code":"hatchingPlot(   data,   useImages = NULL,   region = \"region\",   imageID = \"imageID\",   cellType = \"cellType\",   spatialCoords = c(\"x\", \"y\"),   window = \"concave\",   line.spacing = 21,   hatching.colour = 1,   nbp = 50,   window.length = NULL )  geom_hatching(   mapping = NULL,   data = NULL,   stat = \"identity\",   position = \"identity\",   na.rm = FALSE,   show.legend = NA,   inherit.aes = TRUE,   line.spacing = 21,   hatching.colour = 1,   window = \"concave\",   window.length = NULL,   nbp = 250,   line.width = 1,   ... )"},{"path":"https://github.com/ellispatrick/lisaClust/reference/hatchingPlot.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"hatchingPlot — hatchingPlot","text":"data data displayed layer. three options: NULL, default, data inherited plot data specified  call ggplot(). data.frame, object, override plot  data. objects fortified produce data frame. See fortify()  variables created. function called single argument,   plot data. return value must data.frame, used   layer data. function can created formula (e.g. ~ head(.x, 10)). useImages vector images plot. region region column plot. imageID imageIDs column using data.frame SingleCellExperiment. cellType cellType column using data.frame SingleCellExperiment. spatialCoords spatial coordinates columns using data.frame SingleCellExperiment. window window around regions 'square', 'convex' 'concave'. line.spacing integer indicating spacing hatching lines. hatching.colour colour hatching. nbp integer tuning granularity grid used defining regions window.length tuning parameter controlling level concavity  estimating concave windows. mapping Set aesthetic mappings created aes() aes_(). specified  inherit.aes = TRUE (default), combined default mapping  top level plot. must supply mapping plot mapping. stat statistical transformation use data layer string. position adjustment, either string, result call  position adjustment function. na.rm FALSE, default, missing values removed warning.  TRUE, missing values silently removed. show.legend logical. layer included legends? NA,  default, includes aesthetics mapped. FALSE never includes,  TRUE always includes. can also named logical vector finely select  aesthetics display. inherit.aes FALSE, overrides default aesthetics, rather  combining . useful helper functions define  data aesthetics inherit behaviour default plot  specification, e.g. borders(). line.width numeric controlling width hatching lines ... arguments passed layer(). often aesthetics,  used set aesthetic fixed value, like colour = \"red\" size = 3.  may also parameters paired geom/stat.","code":""},{"path":"https://github.com/ellispatrick/lisaClust/reference/hatchingPlot.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"hatchingPlot — hatchingPlot","text":"ggplot object ggplot geom","code":""},{"path":"https://github.com/ellispatrick/lisaClust/reference/hatchingPlot.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"hatchingPlot — hatchingPlot","text":"","code":"library(spicyR) ## Generate toy data set.seed(51773) x <- round(c(runif(200),runif(200)+1,runif(200)+2,runif(200)+3,              runif(200)+3,runif(200)+2,runif(200)+1,runif(200)),4)*100  y <- round(c(runif(200),runif(200)+1,runif(200)+2,runif(200)+3,               runif(200),runif(200)+1,runif(200)+2,runif(200)+3),4)*100 cellType <- factor(paste('c',rep(rep(c(1:2),rep(200,2)),4),sep = '')) imageID <- rep(c('s1', 's2'),c(800,800)) cells <- data.frame(x, y, cellType, imageID)  ## Store data in SegmentedCells object cellExp <- SegmentedCells(cells, cellTypeString = 'cellType') #> There is no cellID. I'll create these #> There is no image specific imageCellID. I'll create these  ## Generate regions cellExp <- lisaClust(cellExp, k = 2) #> Generating local L-curves. If you run out of memory, try 'fast = FALSE'. #> Creating variable region  ## Plot regions hatchingPlot(cellExp) #> Concave windows are temperamental. Try choosing values of window.length > and < 1 if you have problems.     library(ggplot2)  # Extract the region information along with x-y coordinates df <- as.data.frame(cellSummary(cellExp))  # Plot the regions with geom_hatching() p <- ggplot(df,aes(x = x,y = y, colour = cellType, region = region)) + geom_point() + facet_wrap(~imageID) + geom_hatching()"},{"path":"https://github.com/ellispatrick/lisaClust/reference/inhomLocalK.html","id":null,"dir":"Reference","previous_headings":"","what":"Calculate the inhomogenous local K function. — inhomLocalK","title":"Calculate the inhomogenous local K function. — inhomLocalK","text":"Calculate inhomogenous local K function.","code":""},{"path":"https://github.com/ellispatrick/lisaClust/reference/inhomLocalK.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Calculate the inhomogenous local K function. — inhomLocalK","text":"","code":"inhomLocalK(   data,   Rs = c(20, 50, 100, 200),   sigma = 10000,   window = \"convex\",   window.length = NULL,   minLambda = 0.05,   lisaFunc = \"K\" )"},{"path":"https://github.com/ellispatrick/lisaClust/reference/inhomLocalK.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Calculate the inhomogenous local K function. — inhomLocalK","text":"data data. Rs vector radii measures association calculated. sigma numeric variable used scaling filting inhomogeneous L-curves. window window around regions 'square', 'convex' 'concave'. window.length tuning parameter controlling level concavity. minLambda Minimum value density scaling fitting inhomogeneous L-curves. lisaFunc Either \"K\" \"L\" curve.","code":""},{"path":"https://github.com/ellispatrick/lisaClust/reference/inhomLocalK.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Calculate the inhomogenous local K function. — inhomLocalK","text":"matrix LISA curves","code":""},{"path":"https://github.com/ellispatrick/lisaClust/reference/inhomLocalK.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Calculate the inhomogenous local K function. — inhomLocalK","text":"","code":"library(spicyR) # Read in data as a SegmentedCells objects isletFile <- system.file(\"extdata\", \"isletCells.txt.gz\", package = \"spicyR\") cells <- read.table(isletFile, header = TRUE) cells$x <- cells$AreaShape_Center_X cells$y <- cells$AreaShape_Center_Y cells$cellType <- as.factor(sample(     c(\"big\", \"medium\", \"small\"),     length(cells$AreaShape_Center_Y),     replace = TRUE )) cells$cellID <- as.factor(cells$ObjectNumber)  inhom <- inhomLocalK(cells[1:100,])"},{"path":"https://github.com/ellispatrick/lisaClust/reference/lisa.html","id":null,"dir":"Reference","previous_headings":"","what":"Generate local indicators of spatial association — lisa","title":"Generate local indicators of spatial association — lisa","text":"Generate local indicators spatial association","code":""},{"path":"https://github.com/ellispatrick/lisaClust/reference/lisa.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Generate local indicators of spatial association — lisa","text":"","code":"lisa(   cells,   Rs = NULL,   BPPARAM = BiocParallel::SerialParam(),   window = \"convex\",   window.length = NULL,   whichParallel = \"imageID\",   sigma = NULL,   lisaFunc = \"K\",   minLambda = 0.05,   fast = TRUE,   spatialCoords = c(\"x\", \"y\"),   cellType = \"cellType\",   imageID = \"imageID\" )"},{"path":"https://github.com/ellispatrick/lisaClust/reference/lisa.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Generate local indicators of spatial association — lisa","text":"cells SegmentedCells, SingleCellExperiment, SpatialExperiment data frame contains least  variables x y, giving  coordinates cell, imageID cellType. Rs vector radii measures association calculated. BPPARAM BiocParallelParam object. window window around regions 'square', 'convex' 'concave'. window.length tuning parameter controlling level concavity  estimating concave windows. whichParallel function use parallization imageID  cellType. sigma numeric variable used scaling filting inhomogeneous L-curves. lisaFunc Either \"K\" \"L\" curve. minLambda Minimum value density scaling fitting inhomogeneous L-curves. fast logical describing whether use fast approximation  inhomogeneous local L-curves. spatialCoords columns contain x y spatial coordinates. cellType column contains cell types. imageID column contains image identifiers.","code":""},{"path":"https://github.com/ellispatrick/lisaClust/reference/lisa.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Generate local indicators of spatial association — lisa","text":"matrix LISA curves","code":""},{"path":"https://github.com/ellispatrick/lisaClust/reference/lisa.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Generate local indicators of spatial association — lisa","text":"","code":"library(spicyR) # Read in data as a SegmentedCells objects isletFile <- system.file(\"extdata\",\"isletCells.txt.gz\", package = \"spicyR\") cells <- read.table(isletFile, header=TRUE) cellExp <- SegmentedCells(cells, cellProfiler = TRUE) #> There is no cellType column, setting to NA  # Cluster cell types markers <- cellMarks(cellExp) kM <- kmeans(markers,8) cellType(cellExp) <- paste('cluster',kM$cluster, sep = '')  # Generate LISA lisaCurves <- lisa(cellExp) #> Generating local L-curves. If you run out of memory, try 'fast = FALSE'.  # Cluster the LISA curves kM <- kmeans(lisaCurves,2) cellAnnotation(cellExp, \"region\") <- paste('region',kM$cluster,sep = '_') #> Creating variable region"},{"path":"https://github.com/ellispatrick/lisaClust/reference/lisaClust.html","id":null,"dir":"Reference","previous_headings":"","what":"Use k-means clustering to cluster local indicators of spatial association. For other clustering use lisa. — lisaClust","title":"Use k-means clustering to cluster local indicators of spatial association. For other clustering use lisa. — lisaClust","text":"Use k-means clustering cluster local indicators spatial association. clustering use lisa.","code":""},{"path":"https://github.com/ellispatrick/lisaClust/reference/lisaClust.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Use k-means clustering to cluster local indicators of spatial association. For other clustering use lisa. — lisaClust","text":"","code":"lisaClust(   cells,   k = 2,   Rs = NULL,   spatialCoords = c(\"x\", \"y\"),   cellType = \"cellType\",   imageID = \"imageID\",   regionName = \"region\",   BPPARAM = BiocParallel::SerialParam(),   window = \"convex\",   window.length = NULL,   whichParallel = \"imageID\",   sigma = NULL,   lisaFunc = \"K\",   minLambda = 0.05,   fast = TRUE )"},{"path":"https://github.com/ellispatrick/lisaClust/reference/lisaClust.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Use k-means clustering to cluster local indicators of spatial association. For other clustering use lisa. — lisaClust","text":"cells SegmentedCells, SingleCellExperiment, SpatialExperiment data frame contains least  variables x y, giving  coordinates cell, imageID cellType. k number regions cluster. Rs vector radii measures association calculated. spatialCoords columns contain x y spatial coordinates. cellType column contains cell types. imageID column contains image identifiers. regionName output column lisaClust regions. BPPARAM BiocParallelParam object. window window around regions 'square', 'convex' 'concave'. window.length tuning parameter controlling level concavity  estimating concave windows. whichParallel function use parallization imageID  cellType. sigma numeric variable used scaling filting inhomogeneous L-curves. lisaFunc Either \"K\" \"L\" curve. minLambda Minimum value density scaling fitting inhomogeneous L-curves. fast logical describing whether use fast approximation  inhomogeneous local L-curves.","code":""},{"path":"https://github.com/ellispatrick/lisaClust/reference/lisaClust.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Use k-means clustering to cluster local indicators of spatial association. For other clustering use lisa. — lisaClust","text":"matrix LISA curves","code":""},{"path":"https://github.com/ellispatrick/lisaClust/reference/lisaClust.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Use k-means clustering to cluster local indicators of spatial association. For other clustering use lisa. — lisaClust","text":"","code":"library(spicyR) # Read in data as a SegmentedCells objects isletFile <- system.file(\"extdata\",\"isletCells.txt.gz\", package = \"spicyR\") cells <- read.table(isletFile, header=TRUE) cellExp <- SegmentedCells(cells, cellProfiler = TRUE) #> There is no cellType column, setting to NA  # Cluster cell types markers <- cellMarks(cellExp) kM <- kmeans(markers,8) cellType(cellExp) <- paste('cluster',kM$cluster, sep = '')  # Generate LISA cellExp <- lisaClust(cellExp, k = 2) #> Generating local L-curves. If you run out of memory, try 'fast = FALSE'. #> Creating variable region"},{"path":"https://github.com/ellispatrick/lisaClust/reference/regionMap.html","id":null,"dir":"Reference","previous_headings":"","what":"Plot heatmap of cell type enrichment for lisaClust regions — regionMap","title":"Plot heatmap of cell type enrichment for lisaClust regions — regionMap","text":"Plot heatmap cell type enrichment lisaClust regions","code":""},{"path":"https://github.com/ellispatrick/lisaClust/reference/regionMap.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Plot heatmap of cell type enrichment for lisaClust regions — regionMap","text":"","code":"regionMap(   cells,   type = \"bubble\",   cellType = \"cellType\",   region = \"region\",   limit = c(0.33, 3),   ... )"},{"path":"https://github.com/ellispatrick/lisaClust/reference/regionMap.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Plot heatmap of cell type enrichment for lisaClust regions — regionMap","text":"cells SegmentedCells, SingleCellExperiment, SpatialExperiment data.frame type Make \"bubble\" \"heatmap\" plot. cellType column storing cell types region column storing regions limit limits lower upper relative frequencies ... arguments passed pheatmap package","code":""},{"path":"https://github.com/ellispatrick/lisaClust/reference/regionMap.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Plot heatmap of cell type enrichment for lisaClust regions — regionMap","text":"bubble plot heatmap","code":""},{"path":"https://github.com/ellispatrick/lisaClust/reference/regionMap.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Plot heatmap of cell type enrichment for lisaClust regions — regionMap","text":"","code":"set.seed(51773) x <- round(c(runif(200),runif(200)+1,runif(200)+2,runif(200)+3,             runif(200)+3,runif(200)+2,runif(200)+1,runif(200)),4)*100 y <- round(c(runif(200),runif(200)+1,runif(200)+2,runif(200)+3,             runif(200),runif(200)+1,runif(200)+2,runif(200)+3),4)*100 cellType <- factor(paste('c',rep(rep(c(1:2),rep(200,2)),4),sep = '')) imageID <- rep(c('s1', 's2'),c(800,800))  cells <- data.frame(x, y, cellType, imageID)  cellExp <- spicyR::SegmentedCells(cells, cellTypeString = 'cellType') #> There is no cellID. I'll create these #> There is no image specific imageCellID. I'll create these  cellExp <- lisaClust(cellExp, k = 2) #> Generating local L-curves. If you run out of memory, try 'fast = FALSE'. #> Creating variable region  regionMap(cellExp)"},{"path":"https://github.com/ellispatrick/lisaClust/reference/scale_region.html","id":null,"dir":"Reference","previous_headings":"","what":"Scale constructor for regions — scale_region","title":"Scale constructor for regions — scale_region","text":"Region scale constructor.","code":""},{"path":"https://github.com/ellispatrick/lisaClust/reference/scale_region.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Scale constructor for regions — scale_region","text":"","code":"scale_region(aesthetics = \"region\", ..., guide = \"legend\")  scale_region_manual(..., values)"},{"path":"https://github.com/ellispatrick/lisaClust/reference/scale_region.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Scale constructor for regions — scale_region","text":"aesthetics names aesthetics scale works ... Arguments passed discrete_scale guide function used create guide name. See guides() info. values set aesthetic values map data values .  named vector, values matched based names. unnamed,  values matched order (usually alphabetical) limits scale.  data values match given na.value.","code":""},{"path":"https://github.com/ellispatrick/lisaClust/reference/scale_region.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Scale constructor for regions — scale_region","text":"ggplot guide","code":""},{"path":"https://github.com/ellispatrick/lisaClust/reference/scale_region.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Scale constructor for regions — scale_region","text":"","code":"library(spicyR) ## Generate toy data set.seed(51773) x <- round(c(runif(200),runif(200)+1,runif(200)+2,runif(200)+3,              runif(200)+3,runif(200)+2,runif(200)+1,runif(200)),4)*100  y <- round(c(runif(200),runif(200)+1,runif(200)+2,runif(200)+3,               runif(200),runif(200)+1,runif(200)+2,runif(200)+3),4)*100 cellType <- factor(paste('c',rep(rep(c(1:2),rep(200,2)),4),sep = '')) imageID <- rep(c('s1', 's2'),c(800,800)) cells <- data.frame(x, y, cellType, imageID)  ## Store data in SegmentedCells object cellExp <- SegmentedCells(cells) #> There is no cellID. I'll create these #> There is no image specific imageCellID. I'll create these  ## Generate regions cellExp <- lisaClust(cellExp, k = 2) #> Generating local L-curves. If you run out of memory, try 'fast = FALSE'. #> Creating variable region  # Plot the regions with hatchingPlot() hatchingPlot(cellExp) + scale_region_manual(values = c(1,4), labels = c(\"Region A\", \"Region B\"),  name = \"Regions\") #> Scale for region is already present. #> Adding another scale for region, which will replace the existing scale. #> Concave windows are temperamental. Try choosing values of window.length > and < 1 if you have problems."}]
